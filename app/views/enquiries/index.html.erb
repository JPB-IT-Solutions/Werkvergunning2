<p id="notice"><%= notice %></p>

<header class="navbar navbar-fixed-top navbar-inverse">
  <div class="container">
    <%= link_to "Werkvergunningssysteem", root_path, id: "logo" %>
    <nav>
      <ul class="nav navbar-nav navbar-right">
        <li><%= link_to "Home", root_path %></li>

        <li>
          <% if can? :update, @enquiry %>
              <%= link_to 'Gebruikers', users_path %></li>
          <% end %>
        <li>
          <% if can? :update, @enquiry %>

         <li class="dropdown">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown">
              Beheer <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
              <li><%= link_to "Aannemers", contractors_path %></li>
              <li><%= link_to "Gemachtigden", representatives_path %></li>

              <li class="divider"></li>
              <li>
                <%= link_to "Log out", destroy_user_session_path, method: "delete" %>
              </li>
            </ul>
        <% end %>

                <li class="dropdown">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown">
              Account <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
              <li><%= link_to "Profile", edit_user_registration_path %></li>
              <li class="divider"></li>
              <li>
                <%= link_to "Log out", destroy_user_session_path, method: "delete" %>
              </li>
            </ul>
          </li>

          </ul>
    </nav>
  </div>
</header>
<br><br><br><br>

<div id="main-container" class="container-fluid">
  <div class="row">
    <div id="sidebar" class="col-xs-3">
      <!-- sidebar content -->

      <% if can? :create, Enquiry %>
          <%= link_to 'Werkvergunning aanvragen', new_enquiry_path, class: 'btn btn-success' %><br>
      <% end %>
      <% if can? :update, @enquiry %>
          <%= link_to 'Werkvergunningen', enquiries_path, class: 'btn btn-success' %><br>
      <% end %>
      <% if can? :update, @enquiry %>
          <%= link_to 'Gebruikers', users_path, class: 'btn btn-success' %><br>
      <% end %>
      <% if can? :manage, @enquiry %>
          <%= link_to 'Rollen', roles_path, class: 'btn btn-success' %>
      <% end %>
    </div>
    <div id="content" class="col-xs-9">
      <!--  main content -->
      <h1>JPB Werkvergunningen</h1>
      <p>Welkom bij het JPB werkvergunninssyteem.</p>
      <p>Binnen dit systeem kunt u nieuwe werkvergunningen aanvragen indien u van plan bent</p>
      <p> werkzaamheden te gaan verrichten op een van onze locatie's.</p>



    </div>
  </div>
</div>

<%#link_to 'Nieuwe werkvergunning', new_enquiry_path, class: 'btn btn-success' %><br>

<br>
<hr>
<br>
<div>

  <%= grid(@tasks_grid) do |g|

    g.column name: 'ID', attribute: 'id' do |enq|
      enq.id
    end

    g.column name: 'Referentie', attribute: 'reference' do |enq|
      enq.reference
    end

    g.column name: 'User_id', attribute: 'user_id' do |enq|
      enq.user_id
    end


    g.column name: 'Beschrijving', attribute: 'description' do |enq|
      enq.description
    end

    g.column name: 'Locatie', attribute: 'location' do |enq|
      enq.location
    end

    g.column do |enq|
      link_to('Edit', edit_enquiry_path(enq))
    end
  end -%>

</div>
<% if @enquirie.present? %>

<table class="table table-striped">

  <thead>
  <tr>
    <th>Referentie</th>
    <th>Omschrijving</th>
    <th>locatie</th>
    <th>Datum</th>
  </tr>
  </thead>
  <tbody>

      <% @enquirie.each do |enquiry| %>

          <tr>
            <td>
              <%= enquiry.reference %>
            </td>
            <td>
              <%= enquiry.description %>
            </td>
            <td>
              <%= enquiry.location %>
            </td>
            <td>
              <%= enquiry.date %>
            </td>

            <td><%= link_to 'Show', enquiry, class: 'btn btn-primary btn-xs' %></td>
            <td><%= link_to 'Edit', edit_enquiry_path(enquiry), class: 'btn btn-info btn-xs'  %></td>
            <% if can? :manage, Enquiry %>
            <td><%= link_to 'Destroy', enquiry, method: :delete, data: { confirm: 'Are you sure?' }, class: 'btn btn-danger btn-xs'  %></td>
          <%end%>
                </tr>
          <%end%>
  </tbody>
</table>

          <% else %>
    <% if can? :manage, @enquiry %>
    <table class="table table-striped">
      <thead>
      <tr>
        <th>Referentie</th>
        <th>Omschrijving</th>
        <th>locatie</th>
        <th>Datum</th>
        <th>Aanvrager</th>
      </tr>
      </thead>
      <tbody>
      <% @enquiries.eager_load(:user).each do |enquiry| %>
          <%# @enquiries.each do |enquiry| %>
                     <tr>
                <td>
                  <%= enquiry.reference %>
                </td>
                <td>
                  <%= enquiry.description %>
                </td>
                <td>
                  <%= enquiry.location %>
                </td>
                <td>
                  <%= enquiry.date %>
                </td>
                <td>
                  <%= enquiry.user_id%>

                </td><td>
                       <%= enquiry.user.try(:name) %></td>


                       <td><%= link_to 'Show', enquiry, class: 'btn btn-primary btn-xs' %></td>
                <td><%= link_to 'Edit', edit_enquiry_path(enquiry), class: 'btn btn-info btn-xs'  %></td>
                <td><%= link_to 'Destroy', enquiry, method: :delete, data: { confirm: 'Are you sure?' }, class: 'btn btn-danger btn-xs'  %></td>
              </tr>
<%end%>
      <% end %>

</tbody>
      </table>
  <% end %>
